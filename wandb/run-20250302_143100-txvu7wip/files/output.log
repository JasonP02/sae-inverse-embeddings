Loading models with config: hdbscan
Collecting data with n_prompts=300
Loading prompts from WikiText...
Added 300 prompts from WikiText
Total unique prompts loaded: 300
Processing batch 1/31...
Processing batch 2/31...
Processing batch 3/31...
Processing batch 4/31...
Processing batch 5/31...
Processing batch 6/31...
Processing batch 7/31...
Processing batch 8/31...
Processing batch 9/31...
Processing batch 10/31...
Processing batch 11/31...
Processing batch 12/31...
Processing batch 13/31...
Processing batch 14/31...
Processing batch 15/31...
Processing batch 16/31...
Processing batch 17/31...
Processing batch 18/31...
Processing batch 19/31...
Processing batch 20/31...
Processing batch 21/31...
Processing batch 22/31...
Processing batch 23/31...
Processing batch 24/31...
Processing batch 25/31...
Processing batch 26/31...
Processing batch 27/31...
Processing batch 28/31...
Processing batch 29/31...
Processing batch 30/31...
Collected activations for 300 prompts, 32768 features
Entropy range: -0.00 to 5.49
Sparsity range: 0.00 to 0.89
Entropy percentiles: 10%=-0.0000, 50%=-0.0000, 90%=4.0908
Sparsity percentiles: 10%=0.0000, 50%=0.0000, 90%=0.0000
Kept 11 out of 32768 features
Saving processed data to cache/processed_data_prompts_300_entropy_0.33_5.41_sparsity_0.19_0.92.pt...
Data saved successfully.
Running clustering with method=hdbscan, UMAP=False
Error in sweep run: name 'HDBSCAN_AVAILABLE' is not defined
Traceback (most recent call last):
  File "/home/j/Projects/sae-inverse-embeddings/clustering_sweep.py", line 284, in run_clustering_sweep
    labels, normalized_acts = run_clustering(
  File "/home/j/Projects/sae-inverse-embeddings/pipeline.py", line 116, in run_clustering
    labels, reduced_acts = cluster_features(filtered_acts, clustering_config)
  File "/home/j/Projects/sae-inverse-embeddings/clustering.py", line 129, in cluster_features
    if HDBSCAN_AVAILABLE:
NameError: name 'HDBSCAN_AVAILABLE' is not defined
