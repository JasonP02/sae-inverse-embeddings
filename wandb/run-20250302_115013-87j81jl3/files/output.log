Loading models with config: hdbscan
Collecting data with n_prompts=100
Loading prompts from WikiText...
Added 100 prompts from WikiText
Total unique prompts loaded: 100
Processing batch 1/11...
Processing batch 2/11...
Processing batch 3/11...
Processing batch 4/11...
Processing batch 5/11...
Processing batch 6/11...
Processing batch 7/11...
Processing batch 8/11...
Processing batch 9/11...
Processing batch 10/11...
Collected activations for 100 prompts, 32768 features
Entropy range: -0.00 to 4.36
Sparsity range: 0.00 to 0.70
Entropy percentiles: 10%=-0.0000, 50%=-0.0000, 90%=3.2167
Sparsity percentiles: 10%=0.0000, 50%=0.0000, 90%=0.0000
Kept 10 out of 32768 features
Saving processed data to cache/processed_data_prompts_100_entropy_0.14_4.75_sparsity_0.10_0.92.pt...
Data saved successfully.
Running clustering with method=hdbscan, UMAP=False
Error in sweep run: name 'HDBSCAN_AVAILABLE' is not defined
Traceback (most recent call last):
  File "/home/j/Projects/sae-inverse-embeddings/clustering_sweep.py", line 284, in run_clustering_sweep
    labels, normalized_acts = run_clustering(
  File "/home/j/Projects/sae-inverse-embeddings/pipeline.py", line 116, in run_clustering
    labels, reduced_acts = cluster_features(filtered_acts, clustering_config)
  File "/home/j/Projects/sae-inverse-embeddings/clustering.py", line 127, in cluster_features
    if HDBSCAN_AVAILABLE:
NameError: name 'HDBSCAN_AVAILABLE' is not defined
